<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æœ€å¼·ãƒãƒˆãƒ«ãƒˆãƒ¼ãƒŠãƒ¡ãƒ³ãƒˆ2025</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(to bottom, #1a1a2e, #000);
      font-family: 'Press Start 2P', sans-serif;
      color: #f8f8f8;
      padding-bottom: 5rem;
    }
    .btn {
      padding: 0.75rem 1.5rem;
      background-color: #facc15;
      color: #000;
      font-weight: bold;
      border-radius: 0.5rem;
      box-shadow: 0 0 10px #facc15;
      transition: all 0.2s;
      margin: 0.5rem;
    }
    .btn:hover {
      background-color: #fde047;
    }
    .log {
      background: #111;
      padding: 1em;
      border: 2px solid #333;
      border-radius: 10px;
      font-family: monospace;
      max-height: 300px;
      overflow-y: auto;
    }
    .gallery img {
      max-width: 100px;
      margin: 0.5rem;
      border: 2px solid #00f7ff;
      border-radius: 10px;
    }
    audio {
      display: none;
    }
  </style>
</head>
<body class="p-4">
  <h1 class="text-center text-2xl md:text-3xl font-bold text-yellow-400 mb-4">ğŸ® æœ€å¼·ãƒãƒˆãƒ«ãƒˆãƒ¼ãƒŠãƒ¡ãƒ³ãƒˆ2025 ğŸ®</h1>
  <p class="text-center text-sm text-gray-400 mb-4">ver 1.1</p>

  <div class="text-center mb-6">
    <button id="startBGM" class="btn">ğŸµ BGMã‚’å†ç”Ÿ</button>
    <button id="stopBGM" class="btn">ğŸ”‡ BGMåœæ­¢</button>
  </div>
  <audio id="bgm" loop>
    <source src="https://files.catbox.moe/4zxrrc.mp3" type="audio/mpeg">
  </audio>
  <audio id="clickSound">
    <source src="https://files.catbox.moe/5lg2ox.mp3" type="audio/mpeg">
  </audio>

  <div id="cameraArea" class="text-center mt-8">
    <button id="startCamera" class="btn">ğŸ“¸ ã‚«ãƒ¡ãƒ©ã‚’èµ·å‹•</button><br/>
    <video id="video" autoplay playsinline class="mx-auto mt-4 hidden border-4 border-yellow-400"></video><br/>
    <button id="takePhoto" class="btn hidden mt-2">ğŸ–¼ï¸ å†™çœŸã‚’æ’®ã‚‹</button>
  </div>

  <div id="previewArea" class="hidden text-center mt-8">
    <h2 class="text-xl text-green-400">ã“ã®ç”»åƒã§OKï¼Ÿ</h2>
    <canvas id="canvas" class="border-4 border-green-400 rounded-lg mx-auto my-2"></canvas><br/>
    <button id="retake" class="btn">ğŸ”„ æ’®ã‚Šç›´ã™</button>
    <button id="submitPhoto" class="btn">âœ… ã“ã®ç”»åƒã‚’ä½¿ã†</button>
  </div>

  <div id="battleArea" class="hidden text-center mt-8">
    <h2 class="text-xl text-pink-400">å®Ÿæ³ãƒ¢ãƒ¼ãƒ‰ã‚’é¸ã‚“ã§ãã ã•ã„</h2>
    <select id="modeSelect" class="mt-2 p-2 rounded text-black">
      <option value="random">ğŸ² ãƒ©ãƒ³ãƒ€ãƒ ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰</option>
      <option value="chuunibyou">ğŸ§™ ä¸­äºŒç—…å®Ÿæ³</option>
      <option value="gag">ğŸ‰ ã‚®ãƒ£ã‚°å®Ÿæ³</option>
      <option value="robot">ğŸ¤– ãƒ­ãƒœå®Ÿæ³</option>
      <option value="plain">ğŸ§‘â€ğŸ« æ·¡ã€…å®Ÿæ³</option>
    </select><br/>
    <button id="startBattle" class="btn mt-4">ğŸ”¥ ãƒˆãƒ¼ãƒŠãƒ¡ãƒ³ãƒˆé–‹å§‹</button>
    <div class="log mt-4 text-left text-sm" id="logOutput"></div>
  </div>

  <div id="galleryArea" class="text-center mt-12">
    <h2 class="text-xl text-blue-300 mb-2">ğŸ“¸ ç™»éŒ²é¸æ‰‹ã‚®ãƒ£ãƒ©ãƒªãƒ¼</h2>
    <div id="gallery" class="gallery flex flex-wrap justify-center"></div>
  </div>

  <script>
    const startBtn = document.getElementById('startCamera');
    const video = document.getElementById('video');
    const takeBtn = document.getElementById('takePhoto');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const retakeBtn = document.getElementById('retake');
    const submitBtn = document.getElementById('submitPhoto');
    const previewArea = document.getElementById('previewArea');
    const battleArea = document.getElementById('battleArea');
    const logOutput = document.getElementById('logOutput');
    const gallery = document.getElementById('gallery');
    const bgm = document.getElementById('bgm');
    const clickSound = document.getElementById('clickSound');

    document.getElementById('startBGM').onclick = () => {
      bgm.currentTime = 0;
      bgm.play().catch(e => console.log("BGM error:", e));
    };
    document.getElementById('stopBGM').onclick = () => { bgm.pause(); };

    let stream;

    function playClick() {
      clickSound.currentTime = 0;
      clickSound.play();
    }

    startBtn.onclick = async () => {
      playClick();
      stream = await navigator.mediaDevices.getUserMedia({ video: true });
      video.srcObject = stream;
      video.classList.remove('hidden');
      takeBtn.classList.remove('hidden');
    };

    takeBtn.onclick = () => {
      playClick();
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      ctx.drawImage(video, 0, 0);
      video.classList.add('hidden');
      takeBtn.classList.add('hidden');
      previewArea.classList.remove('hidden');
    };

    retakeBtn.onclick = () => {
      playClick();
      previewArea.classList.add('hidden');
      video.classList.remove('hidden');
      takeBtn.classList.remove('hidden');
    };

    submitBtn.onclick = () => {
      playClick();
      if (stream) stream.getTracks().forEach(track => track.stop());
      previewArea.classList.add('hidden');
      battleArea.classList.remove('hidden');

      const img = new Image();
      img.src = canvas.toDataURL('image/png');
      img.alt = "ç™»éŒ²é¸æ‰‹";
      gallery.appendChild(img);
    };

    document.getElementById('startBattle').onclick = () => {
      playClick();
      const mode = document.getElementById('modeSelect').value;
      const stage = 'ğŸŒ‹ æº¶å²©ã®é—˜æŠ€å ´';
      const sampleLog = `ğŸ¤ å®Ÿæ³ãƒ¢ãƒ¼ãƒ‰: ${mode}<br>
        ğŸŒ‹ æˆ¦é—˜ã‚¹ãƒ†ãƒ¼ã‚¸ï¼š${stage}<br>
        ğŸ¦ ç‹‚ä¹±ã®ãƒ©ã‚¤ã‚ªãƒ³ã‚­ãƒ³ã‚° vs ğŸŠ ãƒ¯ãƒ‹ã‚­ãƒ£ãƒ—ãƒ†ãƒ³ é–‹å§‹ï¼<br>
        ãƒ©ã‚¤ã‚ªãƒ³ã‚­ãƒ³ã‚°ã®å¿…æ®ºæŠ€ã€ãƒ­ãƒ¼ãƒªãƒ³ã‚°å™›ã¿ã¤ãã€ãŒç‚¸è£‚ï¼<br>
        ãƒ¯ãƒ‹ã‚­ãƒ£ãƒ—ãƒ†ãƒ³ã«100ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼ã•ã‚‰ã«ãƒ¯ãƒ‹ã‚­ãƒ£ãƒ—ãƒ†ãƒ³ã¯å‡ºè¡€ã—ã¦ã—ã¾ã£ãŸãƒ¼ï¼<br><br>
        ğŸŒ€ ç•°å¸¸æ°—è±¡ç™ºç”Ÿï¼ çªå¦‚ã€é…¸æ€§ã®é›¨ãŒé™ã‚Šæ³¨ãï¼<br>
        ä¸¡è€…ã¨ã‚‚ã«è¦–ç•Œä¸è‰¯ï¼ã‚¹ãƒªãƒƒãƒ—ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’å—ã‘ãŸï¼<br><br>
        ï¼ˆâ€»ã“ã“ã§æˆ¦é—˜ç”»åƒãŒå¾Œã»ã©ç”Ÿæˆã•ã‚Œã¾ã™ï¼‰<br>`;
      logOutput.innerHTML = sampleLog;
    };
  </script>
</body>
</html>
